{"ast":null,"code":"// scripts/utils.js (module)\nexport function moveToward(entity, targetX, targetY, speed = 1) {\n  let dx = targetX - entity.x;\n  let dy = targetY - entity.y;\n  let stepsX = Math.min(Math.abs(dx), speed) * (dx > 0 ? 1 : dx < 0 ? -1 : 0);\n  let stepsY = Math.min(Math.abs(dy), speed) * (dy > 0 ? 1 : dy < 0 ? -1 : 0);\n  entity.x = Math.max(0, Math.min(20 - 1, entity.x + stepsX));\n  entity.y = Math.max(0, Math.min(40 - 1, entity.y + stepsY));\n}\nexport function updateCombatDialogs(playerComment = \"\", enemyComments = [], player, monsters) {\n  const playerDiv = document.getElementById('combat-player');\n  if (playerDiv) {\n    playerDiv.innerHTML = `${player.name}<br>HP: ${player.hp}<br>${playerComment}`;\n    playerDiv.style.display = 'block';\n  }\n  for (let i = 1; i <= 4; i++) {\n    const enemyDiv = document.getElementById(`combat-enemy${i}`);\n    const monster = monsters[i - 1];\n    if (enemyDiv) {\n      const isFlickering = enemyDiv.classList.contains('flicker');\n      if (monster) {\n        const displayHP = Math.max(0, monster.hp);\n        enemyDiv.innerHTML = `${monster.name}<br>HP: ${displayHP}<br>${enemyComments[i - 1] || \"\"}`;\n        enemyDiv.style.display = 'block';\n\n        // Keep .dead until cleanup (no comment or specific cleanup phase)\n        if (monster.hp <= 0 && (!enemyComments[i - 1] || enemyComments[i - 1] === \"Monster is dead!\")) {\n          enemyDiv.classList.add('dead');\n        } else {\n          enemyDiv.classList.remove('dead');\n          enemyDiv.style.color = '#8B0000';\n          enemyDiv.style.borderColor = '#8B0000';\n        }\n        console.log(`combat-enemy${i}: HP=${monster.hp}, DisplayHP=${displayHP}, Comment=${enemyComments[i - 1]}, Classes=${enemyDiv.classList}, Color=${enemyDiv.style.color}`);\n      } else {\n        enemyDiv.innerHTML = '';\n        enemyDiv.style.display = 'none';\n        enemyDiv.classList.remove('dead', 'flicker');\n        enemyDiv.style.color = '#8B0000';\n        enemyDiv.style.borderColor = '#8B0000';\n      }\n      if (isFlickering && enemyDiv.style.display !== 'none') {\n        enemyDiv.classList.add('flicker');\n      }\n    }\n  }\n}\nexport function updateStatusBar(player) {\n  document.getElementById('hp-display').textContent = `HP: ${player.hp}`;\n  document.getElementById('gear-icon').style.filter = 'invert(15%) sepia(99%) saturate(3000%) hue-rotate(0deg) brightness(70%) contrast(110%)';\n}","map":{"version":3,"names":["moveToward","entity","targetX","targetY","speed","dx","x","dy","y","stepsX","Math","min","abs","stepsY","max","updateCombatDialogs","playerComment","enemyComments","player","monsters","playerDiv","document","getElementById","innerHTML","name","hp","style","display","i","enemyDiv","monster","isFlickering","classList","contains","displayHP","add","remove","color","borderColor","console","log","updateStatusBar","textContent","filter"],"sources":["/mnt/devplex/Nightland/nightland/src/modules/utils.js"],"sourcesContent":["// scripts/utils.js (module)\nexport function moveToward(entity, targetX, targetY, speed = 1) {\n    let dx = targetX - entity.x;\n    let dy = targetY - entity.y;\n    let stepsX = Math.min(Math.abs(dx), speed) * (dx > 0 ? 1 : dx < 0 ? -1 : 0);\n    let stepsY = Math.min(Math.abs(dy), speed) * (dy > 0 ? 1 : dy < 0 ? -1 : 0);\n\n    entity.x = Math.max(0, Math.min(20 - 1, entity.x + stepsX));\n    entity.y = Math.max(0, Math.min(40 - 1, entity.y + stepsY));\n}\n\nexport function updateCombatDialogs(playerComment = \"\", enemyComments = [], player, monsters) {\n    const playerDiv = document.getElementById('combat-player');\n    if (playerDiv) {\n        playerDiv.innerHTML = `${player.name}<br>HP: ${player.hp}<br>${playerComment}`;\n        playerDiv.style.display = 'block';\n    }\n\n    for (let i = 1; i <= 4; i++) {\n        const enemyDiv = document.getElementById(`combat-enemy${i}`);\n        const monster = monsters[i - 1];\n        if (enemyDiv) {\n            const isFlickering = enemyDiv.classList.contains('flicker');\n            \n            if (monster) {\n                const displayHP = Math.max(0, monster.hp);\n                enemyDiv.innerHTML = `${monster.name}<br>HP: ${displayHP}<br>${enemyComments[i - 1] || \"\"}`;\n                enemyDiv.style.display = 'block';\n                \n                // Keep .dead until cleanup (no comment or specific cleanup phase)\n                if (monster.hp <= 0 && (!enemyComments[i - 1] || enemyComments[i - 1] === \"Monster is dead!\")) {\n                    enemyDiv.classList.add('dead');\n                } else {\n                    enemyDiv.classList.remove('dead');\n                    enemyDiv.style.color = '#8B0000';\n                    enemyDiv.style.borderColor = '#8B0000';\n                }\n                \n                console.log(`combat-enemy${i}: HP=${monster.hp}, DisplayHP=${displayHP}, Comment=${enemyComments[i - 1]}, Classes=${enemyDiv.classList}, Color=${enemyDiv.style.color}`);\n            } else {\n                enemyDiv.innerHTML = '';\n                enemyDiv.style.display = 'none';\n                enemyDiv.classList.remove('dead', 'flicker');\n                enemyDiv.style.color = '#8B0000';\n                enemyDiv.style.borderColor = '#8B0000';\n            }\n\n            if (isFlickering && enemyDiv.style.display !== 'none') {\n                enemyDiv.classList.add('flicker');\n            }\n        }\n    }\n}\n\nexport function updateStatusBar(player) {\n    document.getElementById('hp-display').textContent = `HP: ${player.hp}`;\n    document.getElementById('gear-icon').style.filter = 'invert(15%) sepia(99%) saturate(3000%) hue-rotate(0deg) brightness(70%) contrast(110%)';\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}